5 REM *** ORIGEM: GUIA PRATICO DE SISTEMAS GRAFICOS - APPLE II ***
10 REM *********************************
15 REM * FONTE POR FRANCISCO F CARDOSO
20 REM * & LUIZ B M LATERZZA
25 REM *
30 REM * OBJETO POR ALVARO LUIS CRUZ
35 REM *********************************
40 LOMEM = 2048
50 DIM X(100), Y(100), Z(100), V1(200), V2(200), XT(100), YT(100)
70 TEXT: HOME
80 READ NV
90 FOR I = 1 TO NV
100 READ X(I), Y(I), Z(I)
110 NEXT
120 READ NA
130 FOR I = 1 TO NA
140 READ V1(I), V2(I)
150 NEXT
160 HOME : POKE 34,20: HOME
165 PRINT "COORDENADAS DO OBSERVADOR (10, 20, 30)"
166 INPUT "(X,Y,Z) = "; XV, YV, ZV
170 A = SQR(XV ^ 2 + YV ^ 2)
180 B = SQR(XV ^ 2 + YV ^ 2 + ZV ^ 2)
190 K1 = -YV / A
200 K2 = XV / A
210 K3 = -XV * ZV / (A * B)
220 K4 = -YV * ZV / (A * B)
230 K5 = A / B
240 FOR I = 1 TO NV
250 LA = A ^ 2 + 1 / (XV * (X(I) - XV) + YV * (Y(I) - YV) + ZV * (Z(I) - ZV))
260 X = XV + LA * (X(I) - XV)
270 Y = YV + LA * (Y(I) - YV)
280 Z = ZV + LA * (Z(I) - ZV)
290 XT(I) = INT(K1 * X + K2 * Y)
300 YT(I) = K3 * X + K4 * Y + K5 * Z
310 NEXT
320 XIN = X(1): XAX = X(1): YIN = Y(1): YAX = Y(1)
330 FOR I = 1 TO NV
340 IF XIN > XT(I) THEN XIN = XT(I)
350 IF XAX < XT(I) THEN XAX = XT(I)
360 IF YIN > YT(I) THEN YIN = YT(I)
370 IF YAX < YT(I) THEN VAX = YT(I)
380 NEXT
390 XMED = (XAX + XIN) / 2: YMED = (YAX + YIN) / 2
400 KX = 278 / (XAX - XIN): KY = 158 / (VAX - YIN)
410 IF KX < KY THEN K = KX: GOTO 425
420 K = KY
425 X = (278 - (XAX - XIN) * K) / 2
430 FOR I = 1 TO NV
440 XT(I) = (XT(I) - XIN) * K + X
450 YT(I) = 158 - (YT(I) - YIN) * K
460 NEXT
470 HGR2
475 HGOLOR = 3
480 FOR I = 1 TO NA
490 HPLOT XT(V1(I)), YT(V1(I)) TO XT(V2(I)), YT(V2(I))
500 NEXT
800 GET A$: PRINT
805 TEXT
807 IF A$ = "I" THEN INPUT "CARACTERISTICAS DE IMPRESSAO :"; A$: PRINT CHR$(4); "PR#1": PRINT CHR$(9); "G2"; A$: PRINT "(X,Y,Z) = "; XV; " "; YV; " "; ZV: PRINT CHR$(4); "PR#0": GOTO 800
810 GOTO 165
900 REM *** DATA ***
1000 DATA 48 : REM NUMERO DE VERTICES NV
1010 DATA 0,0,0 : REM DADOS DOS VERTICES NA FORMA "DATA X,Y,Z"
1020 DATA 10,0,0
1030 DATA 10,6,0
1040 DATA 0,6,0
1050 DATA 0,0,1
1060 DATA 10,0,1
1070 DATA 10,6,1
1080 DATA 0,6,1
1090 DATA 4.3,1.2,1
1100 DATA 5.7,1.2,1
1110 DATA 6.8,2.2,1
1120 DATA 6.8,3.8,1
1130 DATA 5.7,4.8,1
1140 DATA 4.3,4.8,1
1150 DATA 3.2,3.8,1
1160 DATA 3.2,2.2,1
1170 DATA 4.5,1.8,1
1180 DATA 5.5,1.8,1
1190 DATA 6.2,2.5,1
1200 DATA 6.2,3.5,1
1210 DATA 5.5,4.2,1
1220 DATA 4.5,4.2,1
1230 DATA 3.8,3.5,1
1240 DATA 3.8,2.5,1
1250 DATA 4.3,1.2,5
1260 DATA 5.7,1.2,5
1270 DATA 6.8,2.2,5
1280 DATA 6.8,3.8,5
1290 DATA 5.7,4.8,5
1300 DATA 4.3,4.8,5
1310 DATA 3.2,3.8,5
1320 DATA 3.2,2.2,5
1330 DATA 4.5,1.8,5
1340 DATA 5.5,1.8,5
1350 DATA 6.2,2.5,5
1360 DATA 6.2,3.5,5
1370 DATA 5.5,4.2,5
1380 DATA 4.5,4.2,5
1390 DATA 3.8,3.5,5
1400 DATA 3.8,2.5,5
1410 DATA 1.7,2.2,1
1420 DATA 8.3,2.2,1
1430 DATA 8.3,3.8,1
1440 DATA 1.7,3.8,1
1450 DATA 3.2,2.2,3
1460 DATA 6.8,2.2,3
1470 DATA 6.8,3.8,3
1480 DATA 3.2,3.8,3
2000 DATA 72 : REM NUMERO DE ARESTAS
2010 DATA 1,2 : REM ARESTAS NO FORMATO "DATA ARESTA-INIC, ARESTA-FIM"
2020 DATA 2,3
2030 DATA 3,4
2040 DATA 4,1
2050 DATA 5,6
2060 DATA 6,7
2070 DATA 7,8
2080 DATA 8,5
2090 DATA 1,5
2100 DATA 2,6
2110 DATA 3,7
2120 DATA 4,8
2130 REM CORPO
2140 DATA 9,10
2150 DATA 10,11
2160 DATA 11,12
2170 DATA 12,13
2180 DATA 13,14
2190 DATA 14,15
2200 DATA 15,16
2210 DATA 16,9
2220 DATA 25,26
2230 DATA 26,27
2240 DATA 27,28
2250 DATA 28,29
2260 DATA 29,30
2270 DATA 30,31
2280 DATA 31,32
2290 DATA 32,25
2300 DATA 9,25
2310 DATA 10,26
2320 DATA 11,27
2330 DATA 12,28
2340 DATA 13,29
2350 DATA 14,30
2360 DATA 15,31
2370 DATA 16,32
2380 DATA 17,18
2390 DATA 18,19
2400 DATA 19,20
2410 DATA 20,21
2420 DATA 21,22
2430 DATA 22,23
2440 DATA 23,24
2450 DATA 24,17
2460 DATA 33,34
2470 DATA 34,35
2480 DATA 35,36
2490 DATA 36,37
2500 DATA 37,38
2510 DATA 38,39
2520 DATA 39,40
2530 DATA 40,33
2540 DATA 17,33
2550 DATA 18,34
2560 DATA 19,35
2570 DATA 20,36
2580 DATA 21,37
2590 DATA 22,38
2600 DATA 23,39
2610 DATA 24,40
2620 DATA 41,16
2630 DATA 11,42
2640 DATA 42,43
2650 DATA 43,12
2660 DATA 15,44
2670 DATA 44,41
2680 DATA 41,45
2690 DATA 42,46
2700 DATA 43,47
2710 DATA 44,48
2720 DATA 48,45
2730 DATA 46,47
3000 GOTO 165